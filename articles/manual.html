<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> • mevolCVP2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mevolCVP2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/manual.html">UNKNOWN TITLE</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1></h1>
            
      

      <div class="d-none name"><code>manual.Rmd</code></div>
    </div>

    
    
<table class="table"><tbody>
<tr class="odd">
<td>title: “How to use and build on mevolCVP2”</td>
</tr>
<tr class="even">
<td>output: rmarkdown::html_vignette</td>
</tr>
<tr class="odd">
<td>vignette: &gt;</td>
</tr>
<tr class="even">
<td>%</td>
</tr>
<tr class="odd">
<td>%</td>
</tr>
<tr class="even">
<td>%</td>
</tr>
</tbody></table>
<p>## Foreword ### History</p>
<p>This tiny package (finally) makes available the <a href="https://www.sciencedirect.com/science/article/abs/pii/S030544031200355X" class="external-link">idea
coined</a> by Allowen Evin and colleagues in <em>Journal of
Archaeological Science</em> in 2013.</p>
<p>This approach was previously available as a single script (circa
2013), then wrapped into a <a href="https://github.com/vbonhomme/mevolCVP" class="external-link">package</a> (circa 2018)
without any change to the code and not released on CRAN.</p>
<p>Here, we rethink and rewrote the latter code to have something easier
to build upon.</p>
<p>### The idea The Evin et al. (2013) paper, among others, used
“predictive” discriminant analyses in morphometrical analyses,
particularly in the context of landmark-based morphometrics which uses
principal component analyses prior to LDA.</p>
<p>The idea was two-fold: i) parameterize the optimal number of
principal components to retain for further linear discriminant analyses,
and ii) evaluate the effects of unbalanced sample sized between groups
for further LDA.</p>
<p>Yet this approach deeply changed the way we see, parameterize and do
LDAs unsing morphometrics data, it actually boils down, statistically,
to the following two core ideas and to the very few and thin functions
included in that package.</p>
<p>We present the rationale behind this package, then how it works in
practice, and finally how to extend it to your own needs.</p>
<p>### The rationale</p>
<p>The rational of permutationnal and parameterized discriminant
analyses boils down to: <strong>both the number of variables and the
balance between groups size matter for linear discriminant
analyses.</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>The number of variables is discriminant analyses
matters</strong> and can be optimized.</li>
</ol>
<p>This is typically the case for landmark approaches where a
“preliminary” PCA mandatory and its components later used for LDA. But
even for outline-based approaches, where quantitative variables are not
orthogonal and independant by construction, their number also
matters.</p>
<p>In other words, the common view that a linear discriminant analysis
accuracy increases monotonously with the number of variables you feed it
with is wrong.</p>
<p>Of course, we let apart here many other fundamental aspects such as
measurement error, it is neither reasonable nor meaningful (nor even
allowed) to use 200 principal components or 60 harmonics to train models
that will ultimately be used on degraded archaeological material (or
even fresh)</p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>The group sample sizes matters</strong>. In spite of prior
used by default in LDA (eg in <code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">MASS::lda</a></code>), the class
proportions is not enough to unbias class predictions and consequently
global accuracy. In other words, if you have a dataset with 90% of class
A and 10% of class B, you will “mechanically” have a better
cross-validation accuracy for class A and likely an optimistic global
accuracy too. This is definitely not what we want when we do LDA,
particularly when we used trained models to then make predictions, for
example in the archaeological context.</li>
</ol>
<p>We realized both i) and ii) empirically and yet we are confident that
these can probably be explained mathematically we never find out how and
why.</p>
<p>Along the last ~10 years (2014-&gt;2024), we thus systematically
investigated the number of components (or harmonics) to retain and used
permutations to obtain balanced datasets.</p>
<p>As a side effect, the use of permutationnal approaches typically
allows to obtain the true distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
in other words to compare model performances against pure random. For
morphometrical studies, this allowed to detect subtle yet significant
morphological signals even with relatively low accuracies. In other
words, even a model with 60% accuracy (which is far from impressive) may
be better than random (ie a binomial or a coin) and thus reveal a true
morphological signal.</p>
<p>## mevolCVP2 in practice</p>
<p>### Dependencies</p>
<p>First thing first, you can install the package with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"vbonhomme/mevolCVP2"</span><span class="op">)</span></span></code></pre></div>
<p>Once it will be released on CRAN, this will install the last release
from CRAN:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"mevolCVP2"</span><span class="op">)</span></span></code></pre></div>
<p>We first load the package using <code>library</code>. We also specify
a <a href="https://en.wikipedia.org/wiki/Random_seed" class="external-link">random seed</a>
which is a good idea to have the best of both worlds: randomness
<em>and</em> replicability across your sessions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vbonhomme.github.io/mevolCVP2/">mevolCVP2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2329</span><span class="op">)</span></span></code></pre></div>
<p>We will also use a couple of packages from the <a href="https://www.tidyverse.org/" class="external-link">tidyverse</a> so we load them now:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-presentation">Data presentation<a class="anchor" aria-label="anchor" href="#data-presentation"></a>
</h3>
<p>Here, all analyses will start with a <code>data.frame</code>
with:</p>
<ol style="list-style-type: decimal">
<li>the first column being the grouping structure that can be turned
into a factor (eg a factor or character)</li>
<li>at least one other column being a (or many more) quantitative
variable.</li>
</ol>
<p>Such a dataset is available within the package, named
<code>pig</code> (see <code><a href="../reference/pig.html">?pig</a></code>) and borrowed from the
<em>JAS</em> paper. Let’s have a look to the first and last 3 rows and
the first 3 variables columns:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">minipig</span> <span class="op">&lt;-</span> <span class="va">pig</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">168</span><span class="op">:</span><span class="fl">171</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">minipig</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 4</span></span></span>
<span><span class="co">#&gt;   sp           PC1       PC2       PC3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> WB    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.007<span style="text-decoration: underline;">22</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">179</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> WB    -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">64</span>    0.024<span style="text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> WB     0.025<span style="text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">168</span>  0.010<span style="text-decoration: underline;">1</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> DP     0.000<span style="text-decoration: underline;">023</span>9  0.010<span style="text-decoration: underline;">6</span>    0.009<span style="text-decoration: underline;">64</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> DP    -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.001<span style="text-decoration: underline;">26</span>  -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">53</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> DP    -<span style="color: #BB0000;">0.012</span><span style="color: #BB0000; text-decoration: underline;">1</span>     0.003<span style="text-decoration: underline;">78</span>  -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">59</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> DP    -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">302</span>  0.005<span style="text-decoration: underline;">55</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="helpers">Helpers<a class="anchor" aria-label="anchor" href="#helpers"></a>
</h3>
<p>Below we present helpers and recipes that can easily be reused to you
own analyses.</p>
<div class="section level4">
<h4 id="randomizing-and-selecting-columns">Randomizing and selecting columns<a class="anchor" aria-label="anchor" href="#randomizing-and-selecting-columns"></a>
</h4>
<p>Three core helpers will ease the common operations.</p>
<ul>
<li>
<code>randomize</code> shuffles the first column, ie randomize
grouping labels;</li>
<li>
<code>balance</code> resample rows using the grouping labels, so
that there are <code>n</code> individuals in each group.
<code>n_ind</code> is, by default, the smallest group size. Also,
sampling is done with <code>replace=TRUE</code> by default</li>
<li>
<code>retain</code> will select only <code>n_col</code> from
variables columns (all by default).</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/randomize.html">randomize</a></span><span class="op">(</span><span class="va">minipig</span><span class="op">)</span>  <span class="co"># look at the first column</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 4</span></span></span>
<span><span class="co">#&gt;   sp           PC1       PC2       PC3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> DP    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.007<span style="text-decoration: underline;">22</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">179</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> WB    -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">64</span>    0.024<span style="text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> DP     0.025<span style="text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">168</span>  0.010<span style="text-decoration: underline;">1</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> WB     0.000<span style="text-decoration: underline;">023</span>9  0.010<span style="text-decoration: underline;">6</span>    0.009<span style="text-decoration: underline;">64</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> DP    -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.001<span style="text-decoration: underline;">26</span>  -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">53</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> WB    -<span style="color: #BB0000;">0.012</span><span style="color: #BB0000; text-decoration: underline;">1</span>     0.003<span style="text-decoration: underline;">78</span>  -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">59</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> DP    -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">302</span>  0.005<span style="text-decoration: underline;">55</span></span></span>
<span><span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="va">minipig</span>, n_ind<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># count rows in each group</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   sp           PC1       PC2       PC3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> DP     0.000<span style="text-decoration: underline;">023</span>9  0.010<span style="text-decoration: underline;">6</span>    0.009<span style="text-decoration: underline;">64</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> DP    -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.001<span style="text-decoration: underline;">26</span>  -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">53</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> WB    -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">64</span>    0.024<span style="text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> WB     0.025<span style="text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">168</span>  0.010<span style="text-decoration: underline;">1</span></span></span>
<span><span class="fu"><a href="../reference/retain.html">retain</a></span><span class="op">(</span><span class="va">minipig</span>, n_col<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  <span class="co"># count quantitative variables columns</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 3</span></span></span>
<span><span class="co">#&gt;   sp           PC1       PC2</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> WB    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.007<span style="text-decoration: underline;">22</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> WB    -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">64</span>    0.024<span style="text-decoration: underline;">0</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> WB     0.025<span style="text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">168</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> DP     0.000<span style="text-decoration: underline;">023</span>9  0.010<span style="text-decoration: underline;">6</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> DP    -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.001<span style="text-decoration: underline;">26</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> DP    -<span style="color: #BB0000;">0.012</span><span style="color: #BB0000; text-decoration: underline;">1</span>     0.003<span style="text-decoration: underline;">78</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> DP    -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">302</span></span></span></code></pre></div>
<p>To ease permutations, they are wrapped in <code><a href="../reference/partition.html">partition()</a></code>
that returns a list with four different datasets with self-explanatory
names:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pigs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/partition.html">partition</a></span><span class="op">(</span><span class="va">minipig</span>, n_ind<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">pigs1</span></span>
<span><span class="co">#&gt; $original</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 4</span></span></span>
<span><span class="co">#&gt;   sp           PC1       PC2       PC3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> WB    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.007<span style="text-decoration: underline;">22</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">179</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> WB    -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">64</span>    0.024<span style="text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> WB     0.025<span style="text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">168</span>  0.010<span style="text-decoration: underline;">1</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> DP     0.000<span style="text-decoration: underline;">023</span>9  0.010<span style="text-decoration: underline;">6</span>    0.009<span style="text-decoration: underline;">64</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> DP    -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.001<span style="text-decoration: underline;">26</span>  -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">53</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> DP    -<span style="color: #BB0000;">0.012</span><span style="color: #BB0000; text-decoration: underline;">1</span>     0.003<span style="text-decoration: underline;">78</span>  -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">59</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> DP    -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">302</span>  0.005<span style="text-decoration: underline;">55</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $random</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 4</span></span></span>
<span><span class="co">#&gt;   sp           PC1       PC2       PC3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> DP    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.007<span style="text-decoration: underline;">22</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">179</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> DP    -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">64</span>    0.024<span style="text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> WB     0.025<span style="text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">168</span>  0.010<span style="text-decoration: underline;">1</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> DP     0.000<span style="text-decoration: underline;">023</span>9  0.010<span style="text-decoration: underline;">6</span>    0.009<span style="text-decoration: underline;">64</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> WB    -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.001<span style="text-decoration: underline;">26</span>  -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">53</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> DP    -<span style="color: #BB0000;">0.012</span><span style="color: #BB0000; text-decoration: underline;">1</span>     0.003<span style="text-decoration: underline;">78</span>  -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">59</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> WB    -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">302</span>  0.005<span style="text-decoration: underline;">55</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $balanced</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   sp           PC1       PC2       PC3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> DP    -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">302</span>  0.005<span style="text-decoration: underline;">55</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> DP     0.000<span style="text-decoration: underline;">023</span>9  0.010<span style="text-decoration: underline;">6</span>    0.009<span style="text-decoration: underline;">64</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> DP    -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.001<span style="text-decoration: underline;">26</span>  -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">53</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> WB    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.007<span style="text-decoration: underline;">22</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">179</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> WB    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.007<span style="text-decoration: underline;">22</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">179</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> WB    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.007<span style="text-decoration: underline;">22</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">179</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $balanced_random</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   sp           PC1       PC2       PC3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> DP     0.000<span style="text-decoration: underline;">023</span>9  0.010<span style="text-decoration: underline;">6</span>    0.009<span style="text-decoration: underline;">64</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> WB     0.000<span style="text-decoration: underline;">023</span>9  0.010<span style="text-decoration: underline;">6</span>    0.009<span style="text-decoration: underline;">64</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> DP    -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">302</span>  0.005<span style="text-decoration: underline;">55</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> WB    -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">64</span>    0.024<span style="text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> DP    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.007<span style="text-decoration: underline;">22</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">179</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> WB     0.025<span style="text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">168</span>  0.010<span style="text-decoration: underline;">1</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="lda-calculation-and-digestion">LDA calculation and digestion<a class="anchor" aria-label="anchor" href="#lda-calculation-and-digestion"></a>
</h4>
<p>The workhorse of this package is a thin wrapper on top of
<code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">MASS::lda</a></code> that directly returns the confusion matrix.
<code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">MASS::lda</a></code> is passed with <code>CV=TRUE</code> which returns
leave-one-out cross-validated predictions, digested into a confusion
matrix. Let’s try it on the full <code>pig</code> dataset:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lda1.html">lda1</a></span><span class="op">(</span><span class="va">pig</span><span class="op">)</span></span></code></pre></div>
<p>We can calculate accuracy indices on this confusion matrix. We will
later see how to obtain additional metrics from the latter.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/metrics.html">acc</a></span><span class="op">(</span><span class="va">cm</span><span class="op">)</span></span>
<span><span class="co">#&gt;       acc </span></span>
<span><span class="co">#&gt; 0.8947368</span></span>
<span><span class="fu"><a href="../reference/metrics.html">acc_classes</a></span><span class="op">(</span><span class="va">cm</span><span class="op">)</span></span>
<span><span class="co">#&gt;        DP        WB </span></span>
<span><span class="co">#&gt; 0.7142857 0.9534884</span></span>
<span><span class="fu"><a href="../reference/metrics.html">acc_all</a></span><span class="op">(</span><span class="va">cm</span><span class="op">)</span></span>
<span><span class="co">#&gt;       acc        DP        WB </span></span>
<span><span class="co">#&gt; 0.8947368 0.7142857 0.9534884</span></span></code></pre></div>
<p><code>pig</code> is “highly” unbalanced in terms of sample sizes
between the two groups. We expect a naive LDA on this dataset to be
biased and an LDA on balanced dataset to be more realistic in terms of
class accuracies.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/lda1.html">lda1</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/metrics.html">acc_classes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;        DP        WB </span></span>
<span><span class="co">#&gt; 0.7380952 0.9534884</span></span>
<span><span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/lda1.html">lda1</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/metrics.html">acc_classes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;        DP        WB </span></span>
<span><span class="co">#&gt; 0.8809524 0.8333333</span></span></code></pre></div>
<p>Above, we observe that the class accuracy of the <code>WB</code>
group (larger by more than a factor 3) is drastically reduced and
actually performs less well than <code>DP</code>.</p>
<p>Whether these values are better than pure random have to be properly
tested. We expect, in such binary case, something around 50/50 for pure
random (ie a binomial) but we can be away from this ideal case.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/randomize.html">randomize</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/lda1.html">lda1</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/metrics.html">acc_classes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;       DP       WB </span></span>
<span><span class="co">#&gt; 0.547619 0.452381</span></span></code></pre></div>
<p>We already have pretty much everything we need!</p>
</div>
</div>
<div class="section level3">
<h3 id="in-action-balancing-and-permutating">In action: balancing and permutating<a class="anchor" aria-label="anchor" href="#in-action-balancing-and-permutating"></a>
</h3>
<div class="section level4">
<h4 id="a-single-round">A single round<a class="anchor" aria-label="anchor" href="#a-single-round"></a>
</h4>
<p>Now, we gonna go take profit of functionnal programming tools
provided by <a href="https://purrr.tidyverse.org/" class="external-link">purrr</a>. If you are
not familiar with this package, stop everything and go have a look to
it.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/partition.html">partition</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.df1</span><span class="op">)</span> <span class="va">.df1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/lda1.html">lda1</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/metrics.html">acc_all</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $original</span></span>
<span><span class="co">#&gt;       acc        DP        WB </span></span>
<span><span class="co">#&gt; 0.8947368 0.7142857 0.9534884 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $random</span></span>
<span><span class="co">#&gt;       acc        DP        WB </span></span>
<span><span class="co">#&gt; 0.6257310 0.1666667 0.7751938 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $balanced</span></span>
<span><span class="co">#&gt;       acc        DP        WB </span></span>
<span><span class="co">#&gt; 0.9642857 0.9523810 0.9761905 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $balanced_random</span></span>
<span><span class="co">#&gt;       acc        DP        WB </span></span>
<span><span class="co">#&gt; 0.4642857 0.5476190 0.3809524</span></span></code></pre></div>
<p>The results above should reflect the expectations and results we
observed before, doing it “by hand”, line after line.</p>
<p>Let’s wrap this into a function that would accept any dataset. We
also arrange a bit what comes out of the <code>map</code> into a nice
and named tibble.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perm1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/partition.html">partition</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="va">.x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/lda1.html">lda1</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/metrics.html">acc_all</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">.</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"partition"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">perm1</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   partition         acc    DP    WB</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> original        0.895 0.714 0.953</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> random          0.673 0.167 0.837</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> balanced        0.810 0.857 0.762</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> balanced_random 0.321 0.333 0.310</span></span></code></pre></div>
<p>Can you see where we’re going here? So let fun begins and we let’s
replicate these permutations.</p>
</div>
<div class="section level4">
<h4 id="more-than-a-single-round">More than a single round<a class="anchor" aria-label="anchor" href="#more-than-a-single-round"></a>
</h4>
<p>Here we go for 10 rounds for the sake of speed while writing and
compiling the package but feel free to change it by your side.</p>
<p>We will come back to the full <code>pig</code> and use a
<code>map</code> variant, the <code>_dfr</code> version, that directly
rbinds the intermediate list into a tibble. Feel free try the raw
<code>map</code> below.</p>
<p><strong>Everything that follows will adhere to this idea: combine the
few helpers, do permutations using <code>map</code> and friends,
summarize and graph.</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K</span><span class="op">=</span><span class="fl">10</span></span>
<span><span class="va">pig10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>, \<span class="op">(</span><span class="va">iter</span><span class="op">)</span> <span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">perm1</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pig10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   partition         acc    DP    WB</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> original        0.901 0.738 0.953</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> random          0.637 0.143 0.798</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> balanced        0.821 0.929 0.714</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> balanced_random 0.571 0.595 0.548</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> original        0.895 0.714 0.953</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> random          0.637 0.190 0.783</span></span></code></pre></div>
<p>Let’s summarise this a bit with <code>dplyr</code> so that we can
summatise the mean and the SD:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pig10</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">partition</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"median"</span><span class="op">=</span><span class="va">median</span>, <span class="st">"sd"</span><span class="op">=</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">#&gt;   partition       acc_median  acc_sd DP_median  DP_sd WB_median  WB_sd</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> balanced             0.833 0.041<span style="text-decoration: underline;">3</span>      0.881 0.040<span style="text-decoration: underline;">8</span>     0.786 0.065<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> balanced_random      0.470 0.076<span style="text-decoration: underline;">4</span>      0.488 0.085<span style="text-decoration: underline;">6</span>     0.464 0.098<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> original             0.901 0.003<span style="text-decoration: underline;">02</span>     0.738 0.012<span style="text-decoration: underline;">3</span>     0.953 0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> random               0.637 0.026<span style="text-decoration: underline;">0</span>      0.190 0.077<span style="text-decoration: underline;">8</span>     0.791 0.020<span style="text-decoration: underline;">3</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="summary-and-graph">Summary and graph<a class="anchor" aria-label="anchor" href="#summary-and-graph"></a>
</h4>
<p>Alternatively, to get a more compact table:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_sd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"±"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pig10</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">partition</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">mean_sd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   partition       acc         DP          WB         </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> balanced        0.83±0.041  0.871±0.041 0.788±0.066</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> balanced_random 0.487±0.076 0.49±0.086  0.483±0.099</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> original        0.898±0.003 0.729±0.012 0.953±0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> random          0.649±0.026 0.19±0.078  0.798±0.02</span></span></code></pre></div>
<p>We can also have a nice graph after a little pivoting step to please
<code>ggplot2</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pig10</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>partition<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">partition</span>, </span>
<span>                          levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"random"</span>, <span class="st">"balanced_random"</span>, <span class="st">"balanced"</span><span class="op">)</span>, ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># order partition for graphics purposes</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">acc</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"what"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># pivot the tibble to a longer form</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">partition</span>, y<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">what</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="manual_files/figure-html/gg1-1.png" width="700"></p>
<p>The <em>original</em> results is the one you would obtain without
touching your original dataset: global accuracy is overestimated as weel
as WB class. When you look at <em>balanced</em> this is corrected. This
model performs clearly better than <em>balanced_random</em> which is
pure random. Sounds like there is a strong morphological signal in
there!</p>
</div>
</div>
<div class="section level3">
<h3 id="in-action-adding-variable-selection">In action: adding variable selection<a class="anchor" aria-label="anchor" href="#in-action-adding-variable-selection"></a>
</h3>
<p>Let’s sophisticate a bit the <code>perm1</code> function to allow for
selecting more or less variables to feed the LDA with. We simply add a
<code>n_col</code> argument that we pass to <code><a href="../reference/retain.html">retain()</a></code>,
coined before <code><a href="../reference/partition.html">partition()</a></code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perm2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n_col</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/retain.html">retain</a></span><span class="op">(</span><span class="va">n_col</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/partition.html">partition</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="va">.x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/lda1.html">lda1</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/metrics.html">acc_all</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">.</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"partition"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We expect that 20 components would perform better than a single one.
Let’s check it on a single round, and indeed:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">perm2</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   partition         acc    DP    WB</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> original        0.813 0.405 0.946</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> random          0.754 0     1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> balanced        0.774 0.762 0.786</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> balanced_random 0.548 0.5   0.595</span></span>
<span><span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">perm2</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   partition         acc     DP    WB</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> original        0.912 0.786  0.953</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> random          0.684 0.095<span style="text-decoration: underline;">2</span> 0.876</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> balanced        0.940 0.952  0.929</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> balanced_random 0.524 0.5    0.548</span></span></code></pre></div>
<p>We can easily write this into a map. We also record the number of
variables and make it return directly a single, rbinded data.frame with
<code>map_dfr</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, \<span class="op">(</span><span class="va">n_col</span><span class="op">)</span> <span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">perm2</span><span class="op">(</span><span class="va">n_col</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>retain<span class="op">=</span><span class="va">n_col</span>, .before<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   retain partition         acc    DP    WB</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1 original        0.813 0.405 0.946</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      1 random          0.754 0     1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      1 balanced        0.798 0.810 0.786</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      1 balanced_random 0.560 0.619 0.5  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>      2 original        0.807 0.452 0.922</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>      2 random          0.754 0     1</span></span></code></pre></div>
<p>To replicate this calculation K times, we simply wrap it into an
additional layer of <code>map</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K</span><span class="op">=</span><span class="fl">10</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>,</span>
<span>        \<span class="op">(</span><span class="va">iter</span><span class="op">)</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, \<span class="op">(</span><span class="va">n_col</span><span class="op">)</span> <span class="va">pig</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">perm2</span><span class="op">(</span><span class="va">n_col</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>retain<span class="op">=</span><span class="va">n_col</span>, .before<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>iter<span class="op">=</span><span class="va">iter</span>, .before<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;    iter retain partition         acc    DP    WB</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1      1 original        0.813 0.405 0.946</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1      1 random          0.754 0     1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1      1 balanced        0.821 0.714 0.929</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1      1 balanced_random 0.536 0.452 0.619</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1      2 original        0.807 0.452 0.922</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1      2 random          0.754 0     1</span></span></code></pre></div>
<p>Let’s plot this beauty:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">acc</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span>, names_to<span class="op">=</span><span class="st">"metric"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">retain</span>, y<span class="op">=</span><span class="va">value</span>, col<span class="op">=</span><span class="va">partition</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">metric</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"number of PC retained"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"CV accuracy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="manual_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="graphics">Graphics<a class="anchor" aria-label="anchor" href="#graphics"></a>
</h2>
</div>
<div class="section level2">
<h2 id="recipes">Recipes<a class="anchor" aria-label="anchor" href="#recipes"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vincent Bonhomme, Allowen Evin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
