<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to use (and build on) mevolCVP2 • mevolCVP2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use (and build on) mevolCVP2">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mevolCVP2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/manual.html">How to use (and build on) mevolCVP2</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>How to use (and build on) mevolCVP2</h1>
            
      

      <div class="d-none name"><code>manual.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="preamble">Preamble<a class="anchor" aria-label="anchor" href="#preamble"></a>
</h2>
<p>This tiny package (finally) releases the <a href="https://www.sciencedirect.com/science/article/abs/pii/S030544031200355X" class="external-link">seminal
idea coined</a> by Allowen Evin and colleagues in <em>Journal of
Archaeological Science</em> in 2013.</p>
<p>This approach was previously available as a single script (circa
2013), then wrapped into a <a href="https://github.com/vbonhomme/mevolCVP" class="external-link">package</a> (circa 2018)
without any change to the code and not released on CRAN. Here, we
rethink and rewrote the latter code to have something easier to build
upon.</p>
<p>The Evin et al. (2013) paper, among others, used “predictive”
discriminant analyses in morphometrical analyses, particularly in the
context of landmark-based morphometrics which uses principal component
analyses prior to LDA.</p>
<p>The idea was two-fold: i) parameterized the optimal number of
principal components to retain for further linear discriminant analyses,
and ii) evaluated the effects of unbalanced sample sized between groups
for LDA.</p>
<p>Yet this approach deeply changed the way we see, parameterize and do
LDAs in morphometrics, it actualy boils down, statistically, to the
following two core ideas.</p>
</div>
<div class="section level2">
<h2 id="rationale">Rationale<a class="anchor" aria-label="anchor" href="#rationale"></a>
</h2>
<p>The rational of permutationnal and parameterized discriminant
analyses boils down to two ideas:</p>
<ol style="list-style-type: decimal">
<li>
<strong>The number of variables is discriminant analyses
matters</strong> and can be optimized.</li>
</ol>
<p>This is typically the case for landmark approaches where a
“preliminary” PCA mandatory and its components later used for LDA. But
even for outline-based approaches, where quantitative variables are not
orthogonal and independant by construction, their number also
matters.</p>
<p>In other words, the common view that a linear discriminant analysis
accuracy increases monotonously with the number of variables you feed it
with is wrong.</p>
<p>Of course, we let apart here many other fundamental aspects such as
measurement error, it is neither reasonable nor meaningful (nor even
allowed) to use 200 principal components or 60 harmonics to train models
that will ultimately be used on degraded archaeological material (or
even fresh)</p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>The group sample sizes matters</strong>. In spite of prior
used by default in LDA (eg in <code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">MASS::lda</a></code>), the class
proportions is not enough to unbias class predictions and consequently
global accuracy. In other words, if you have a dataset with 90% of class
A and 10% of class B, you will “mechanically” have a better
cross-validation accuracy for class A and likely an optimistic global
accuracy too. This is definitely not what we want when we do LDA,
particularly when we used trained models to then make predictions, for
example in the archaeological context.</li>
</ol>
<p>We realized both i) and ii) empirically and yet we are confident that
these can probably be explained mathematically we never find out how and
why.</p>
<p>Along the last ~10 years (2014-&gt;2024), we thus systematically
investigated the number of components (or harmonics) to retain and used
permutations to obtain balanced datasets.</p>
<p>As a side effect, the use of permutationnal approaches typically
allows to obtain the true distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
in other words to compare model performances against pure random. For
morphometrical studies, this allowed to detect subtle yet significant
morphological signals even with relatively low accuracies. In other
words, even a model with 60% accuracy (which is far from impressive) may
be better than random (ie a binomial or a coin) and thus reveal a true
morphological signal.</p>
</div>
<div class="section level2">
<h2 id="architecture">Architecture<a class="anchor" aria-label="anchor" href="#architecture"></a>
</h2>
<p>Programmatically, the last section boils down to: i) retain more or
less variables, ii) do a lot of permutations. Consequently, this
packages consists of very few and thin wrappers around (very) common
statistical operations. We nevertheless hope it will set a common ground
for morphometrics enthusiasts, help ourselves and newcomers in daily
explorations and ease more sophisticated ones.</p>
<p>Here, all analyses will start with a <code>data.frame</code> with: 1)
the first column being the grouping structure that can be turned into a
factor (eg a factor or character) 2) at least one other column being a
(or many more) quantitative variable.</p>
<p>We first load the package using <code>library</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vbonhomme.github.io/mevolCVP2/">mevolCVP2</a></span><span class="op">)</span></span></code></pre></div>
<p>We will use the built-in <code>pig</code> dataset, borrowed from the
<em>JAS</em> paper. Let’s have a look to the first and last 5 rows and
the first 3 columns:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">pig</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">166</span><span class="op">:</span><span class="fl">171</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;     sp           PC1           PC2           PC3          PC4           PC5</span></span>
<span><span class="co">#&gt; 1   WB -2.467725e-02  0.0072224577 -0.0001790668  0.011881194 -0.0009818745</span></span>
<span><span class="co">#&gt; 2   WB -8.637212e-03  0.0239918850 -0.0002652039  0.009237132 -0.0142818922</span></span>
<span><span class="co">#&gt; 3   WB  2.540836e-02 -0.0001676755  0.0100646985  0.001353267 -0.0065766928</span></span>
<span><span class="co">#&gt; 4   WB -4.381549e-02 -0.0029845435 -0.0009553462  0.009690195  0.0186499046</span></span>
<span><span class="co">#&gt; 5   WB  1.368996e-02  0.0048695525  0.0176407878 -0.003924953 -0.0116175659</span></span>
<span><span class="co">#&gt; 166 DP -2.868456e-02 -0.0630233879 -0.0148804598  0.001632507 -0.0029347196</span></span>
<span><span class="co">#&gt; 167 DP -7.910084e-02 -0.0079671135  0.0072650895  0.007142158 -0.0086475770</span></span>
<span><span class="co">#&gt; 168 DP  2.387963e-05  0.0106218186  0.0096436493 -0.001926465  0.0067834675</span></span>
<span><span class="co">#&gt; 169 DP -4.201241e-02  0.0012598814 -0.0075265494  0.009958453  0.0016966005</span></span>
<span><span class="co">#&gt; 170 DP -1.209965e-02  0.0037795891 -0.0015912658  0.002923668  0.0091559514</span></span>
<span><span class="co">#&gt; 171 DP -5.043986e-02 -0.0003020287  0.0055480180 -0.002182170 -0.0121354100</span></span></code></pre></div>
<p>Then three core helpers ease the common operations:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/randomize.html">randomize</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="co"># look at the first column</span></span>
<span><span class="co">#&gt;     sp           PC1           PC2           PC3          PC4           PC5</span></span>
<span><span class="co">#&gt; 1   DP -2.467725e-02  0.0072224577 -0.0001790668  0.011881194 -0.0009818745</span></span>
<span><span class="co">#&gt; 2   WB -8.637212e-03  0.0239918850 -0.0002652039  0.009237132 -0.0142818922</span></span>
<span><span class="co">#&gt; 3   DP  2.540836e-02 -0.0001676755  0.0100646985  0.001353267 -0.0065766928</span></span>
<span><span class="co">#&gt; 4   DP -4.381549e-02 -0.0029845435 -0.0009553462  0.009690195  0.0186499046</span></span>
<span><span class="co">#&gt; 5   DP  1.368996e-02  0.0048695525  0.0176407878 -0.003924953 -0.0116175659</span></span>
<span><span class="co">#&gt; 166 WB -2.868456e-02 -0.0630233879 -0.0148804598  0.001632507 -0.0029347196</span></span>
<span><span class="co">#&gt; 167 WB -7.910084e-02 -0.0079671135  0.0072650895  0.007142158 -0.0086475770</span></span>
<span><span class="co">#&gt; 168 DP  2.387963e-05  0.0106218186  0.0096436493 -0.001926465  0.0067834675</span></span>
<span><span class="co">#&gt; 169 DP -4.201241e-02  0.0012598814 -0.0075265494  0.009958453  0.0016966005</span></span>
<span><span class="co">#&gt; 170 WB -1.209965e-02  0.0037795891 -0.0015912658  0.002923668  0.0091559514</span></span>
<span><span class="co">#&gt; 171 WB -5.043986e-02 -0.0003020287  0.0055480180 -0.002182170 -0.0121354100</span></span>
<span><span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># count rows in each group</span></span>
<span><span class="co">#&gt;     sp         PC1           PC2          PC3         PC4          PC5</span></span>
<span><span class="co">#&gt; 170 DP -0.01209965  0.0037795891 -0.001591266 0.002923668  0.009155951</span></span>
<span><span class="co">#&gt; 167 DP -0.07910084 -0.0079671135  0.007265090 0.007142158 -0.008647577</span></span>
<span><span class="co">#&gt; 3   WB  0.02540836 -0.0001676755  0.010064699 0.001353267 -0.006576693</span></span>
<span><span class="co">#&gt; 3.1 WB  0.02540836 -0.0001676755  0.010064699 0.001353267 -0.006576693</span></span>
<span><span class="fu"><a href="../reference/retain.html">retain</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span>  <span class="co"># count quantitative variables columns</span></span>
<span><span class="co">#&gt;     sp           PC1           PC2           PC3</span></span>
<span><span class="co">#&gt; 1   WB -2.467725e-02  0.0072224577 -0.0001790668</span></span>
<span><span class="co">#&gt; 2   WB -8.637212e-03  0.0239918850 -0.0002652039</span></span>
<span><span class="co">#&gt; 3   WB  2.540836e-02 -0.0001676755  0.0100646985</span></span>
<span><span class="co">#&gt; 4   WB -4.381549e-02 -0.0029845435 -0.0009553462</span></span>
<span><span class="co">#&gt; 5   WB  1.368996e-02  0.0048695525  0.0176407878</span></span>
<span><span class="co">#&gt; 166 DP -2.868456e-02 -0.0630233879 -0.0148804598</span></span>
<span><span class="co">#&gt; 167 DP -7.910084e-02 -0.0079671135  0.0072650895</span></span>
<span><span class="co">#&gt; 168 DP  2.387963e-05  0.0106218186  0.0096436493</span></span>
<span><span class="co">#&gt; 169 DP -4.201241e-02  0.0012598814 -0.0075265494</span></span>
<span><span class="co">#&gt; 170 DP -1.209965e-02  0.0037795891 -0.0015912658</span></span>
<span><span class="co">#&gt; 171 DP -5.043986e-02 -0.0003020287  0.0055480180</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vincent Bonhomme, Allowen Evin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
